{{#*inline "beatSection"}}
<h2>
    {{localizeHeart "beat" (join "" type "-beat") "label-multiple"}}
    {{#if (and editable (not item.isOwned))}}
    <a class="right" data-action="add-child" data-type="beat" data-data='{"type": "{{type}}"}'><span class="fas fa-plus"></span> {{localizeHeart "beat" (join "" type "-beat") "add"}}</a>
    {{/if}}
</h2>
<div class="item-list">
    {{#each beats as |beat|}}
        {{> "heart:items/beat/preview.html" item=beat}}
    {{/each}}
</div>
{{/inline}}

<form class="heart sheet base Item calling {{cssClass}}" autocomplete="off">
    <h1>
        {{#if (and editable (not item.isOwned))}}
        <input name="name" value="{{data.name}}"/>
        {{else}}
        {{item.name}}
        {{/if}}
    </h1>
    <div class="description">
        {{#if (and editable (not item.isOwned))}}
        {{editor content=data.data.description target="data.description" button=true editable=editable owner=owner}}
        {{else}}
        {{{data.data.description}}}
        {{/if}}
    </div>

    <h4>
        {{localizeHeart "calling" "questions" "prompt"}}
        {{#if (and editable (not item.isOwned))}}
        <a class="right" data-action="add-question"><span class="fas fa-plus"></span> {{localizeHeart "calling" "questions" "add"}}</a>
        {{/if}}
    </h4>
    <ul>
    {{#each data.data.questions as |question id|}}
        <li data-id="{{id}}">
            <div class="flexrow">
                {{#if ../item.isOwned}}
                <div>
                    <div class="question">{{{question.question}}}</div>
                    {{#if ../editable}}
                    {{editor content=question.answer target=(join "." "data.questions" id "answer") button=true editable=../editable owner=owner}}
                    {{else}}
                    <div>{{{question.answer}}}</div>
                    {{/if}}
                </div>
                {{else}}
                    {{#if ../editable}}
                    <div class="question">
                        {{editor content=question.question target=(join "." "data.questions" id "question") button=true editable=../editable owner=owner}}
                    </div>
                    {{else}}
                    <div>{{{question.question}}}</div>
                    {{/if}}
                {{/if}}
                {{#if (and ../editable (not ../item.isOwned))}}
                <a class="action" data-action="delete-question"><span class="fas fa-trash"></span> {{localizeHeart "calling" "questions" "delete"}}</a>
                {{/if}}
            </div>    
        </li>
    {{/each}}
    </ul>


    <h2>
        {{#if (eq data.data.abilities.length 1)}}
            {{localizeHeart "calling" "core-ability" "label-single"}}
        {{else}}
            {{localizeHeart "calling" "core-ability" "label-multiple"}}
        {{/if}}
        {{#if (and editable (not item.isOwned))}}
        <a class="right" data-action="add-child" data-type="ability"><span class="fas fa-plus"></span> {{localizeHeart "calling" "core-ability" "add"}}</a>
        {{/if}}
    </h2>
    <div class="item-list">
        {{#each childrenTypes.ability as |ability|}}
            {{> "heart:items/ability/preview.html" item=ability showActivate=true}}
        {{/each}}
    </div>

    {{> beatSection beats=minorBeats type="minor"}}
    {{> beatSection beats=majorBeats type="major"}}
    {{> beatSection beats=zenithBeats type="zenith"}}
</form>